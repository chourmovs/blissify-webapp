<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion NAS et Commandes</title>
</head>
<body>
    <h1>Blissify WebApp by chourmovs</h1>

    <h3>1 -1rst step</h3> <br>
    
    <form id="network-p <br>ath-form">
        <label for="network-path">Network share path :</label>
        <input type="text" id="network-path" name="path">
        <button type="submit">Mount the network share</button>
    </form>
     <br>

    <h3>2 - 2nd step:</h3> 
    <button id="mpc-update-button">MPC update</button>
    <br>
    <h3>1 - 3rd step</h3>
    <button id="blissify-init-button">Blissify Init</button>
    <br>
    <h3>1 -If update is needed</h3> <br>
    <button id="blissify-update-button">Blissify Update</button>
    <br>
    <!-- Conteneur pour afficher l'output des commandes -->
     <pre id="console-output"></pre>

    <script>
        function displayOutput(data) {
            // Affiche l'output dans le conteneur dédié
            document.getElementById('console-output').innerText += data;
        }

        document.getElementById('network-path-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const networkPath = document.getElementById('network-path').value;

            // Monter le partage NAS
            fetch(`/mount-nas?path=${encodeURIComponent(networkPath)}`)
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors du montage : ${error}`);
                });
        });

        document.getElementById('mpc-update-button').addEventListener('click', function() {
            // Mise à jour MPC après montage
            fetch('/mpc-update')
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors de la mise à jour MPC : ${error}`);
                });
        });

        document.getElementById('blissify-init-button').addEventListener('click', function() {
            // Lancer blissify init
            fetch('/start-analysis')
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors de l'exécution de blissify init : ${error}`);
                });
        });

        document.getElementById('blissify-update-button').addEventListener('click', function() {
            // Lancer blissify update
            fetch('/blissify-update')
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors de l'exécution de blissify update : ${error}`);
                });
        });
    </script>
</body>
</html>
