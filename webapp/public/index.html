<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion NAS et Commandes</title>
</head>
<body>
    <h1>Blissify WebApp by chourmovs</h1>

    <form id="network-path-form">
        <label for="network-path">Chemin du partage NAS :</label>
        <input type="text" id="network-path" name="path">
        <button type="submit">Monter le partage NAS</button>
    </form>

    <button id="mpc-update-button">Mise à jour MPC</button>
    <button id="blissify-init-button">Blissify Init</button>
    <button id="blissify-update-button">Blissify Update</button>

    <!-- Conteneur pour afficher l'output des commandes -->
    <pre id="console-output"></pre>

    <script>
        function displayOutput(data) {
            // Affiche l'output dans le conteneur dédié
            document.getElementById('console-output').innerText = data;
        }

        document.getElementById('network-path-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const networkPath = document.getElementById('network-path').value;

            // Monter le partage NAS
            fetch(`/mount-nas?path=${encodeURIComponent(networkPath)}`)
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors du montage : ${error}`);
                });
        });

        document.getElementById('mpc-update-button').addEventListener('click', function() {
            // Mise à jour MPC après montage
            fetch('/mpc-update')
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors de la mise à jour MPC : ${error}`);
                });
        });

        document.getElementById('blissify-init-button').addEventListener('click', function() {
            // Lancer blissify init
            fetch('/start-analysis')
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors de l'exécution de blissify init : ${error}`);
                });
        });

        document.getElementById('blissify-update-button').addEventListener('click', function() {
            // Lancer blissify update
            fetch('/blissify-update')
                .then(response => response.text())
                .then(displayOutput)
                .catch(error => {
                    displayOutput(`Erreur lors de l'exécution de blissify update : ${error}`);
                });
        });
    </script>
</body>
</html>
